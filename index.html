<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMOKE HUB | –ö–∞—Ç–∞–ª–æ–≥</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* –°—Ç–∏–ª—ñ –¥–ª—è –Ω–∞–∫–ª–∞–¥–∞–Ω–Ω—è —Å—Ç—ñ–∫–µ—Ä—ñ–≤ –Ω–∞ —Ñ–æ—Ç–æ */
        .product-img {
            position: relative; /* –ë–∞–∑–∞ –¥–ª—è –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è */
            overflow: hidden;
            border-radius: 12px;
        }

        .badge {
            position: absolute; /* –ù–∞–∫–ª–∞–¥–∞–Ω–Ω—è –ø–æ–≤–µ—Ä—Ö */
            top: 10px;
            left: 10px;
            z-index: 10;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 900;
            text-transform: uppercase;
            pointer-events: none;
            display: none; /* –•–æ–≤–∞—î–º–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º */
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .badge-hit {
            display: block;
            background: #ff0055;
            color: white;
        }

        .badge-promo {
            display: block;
            background: #ffd900;
            color: black;
        }

        /* –í–∏–¥–∞–ª—è—î–º–æ —Å—Ç–∞—Ä—ñ –≤—ñ–¥—Å—Ç—É–ø–∏, —è–∫—ñ –º–æ–≥–ª–∏ –±—É—Ç–∏ */
        .product-card .badge:empty {
            display: none;
        }
    </style>
</head>
<body>
<canvas id="snow-canvas"></canvas>

<div class="dev-trigger" onclick="openDevAuth()" title="Admin"></div>
<div id="dev-login" class="dev-panel">
    <div class="admin-box">
        <div class="admin-title">üîê ADMIN LOGIN</div>
        <input id="dev-user" type="text" placeholder="–õ–æ–≥—ñ–Ω">
        <input id="dev-pass" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
        <button class="btn-main" onclick="checkDevAuth()">–£–í–Ü–ô–¢–ò</button>
        <button class="btn-alt" onclick="closeAllPanels()">–°–ö–ê–°–£–í–ê–¢–ò</button>
    </div>
</div>

<div id="dev-menu" class="dev-panel mobile-admin-panel">
    <div class="admin-box">
        <div class="admin-title">‚öôÔ∏è –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</div>
        <div class="admin-tabs">
            <button class="tab-btn active" onclick="openTab('edit')">–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è</button>
            <button class="tab-btn" onclick="openTab('stickers')">–°—Ç—ñ–∫–µ—Ä–∏</button>
        </div>

        <div id="tab-edit" class="tab-content active">
            <button onclick="toggleEdit('price')">üí∞ –¶—ñ–Ω–∏</button>
            <button onclick="toggleEdit('desc')">üìù –ù–∞–∑–≤–∏</button>
            <button onclick="toggleStockMode()">üì¶ –°–∫–ª–∞–¥</button>
            <button onclick="toggleImgMode()">üñº –§–æ—Ç–æ</button>
        </div>

        <div id="tab-stickers" class="tab-content">
            <label>–í–∏–±–µ—Ä—ñ—Ç—å —Å—Ç—ñ–∫–µ—Ä:</label>
            <select id="badge-selector">
                <option value="">üö´ –ë–µ–∑ —Å—Ç—ñ–∫–µ—Ä–∞</option>
                <option value="hit">üî• –•—ñ—Ç</option>
                <option value="promo">üè∑ –ê–∫—Ü—ñ—è</option>
            </select>
            <small>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —Ç–æ–≤–∞—Ä –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è</small>
        </div>

        <div class="admin-actions">
            <button class="btn-save" onclick="adminSave()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
            <button class="btn-exit" onclick="devLogout()">üö™ –í–∏–π—Ç–∏</button>
        </div>
    </div>
</div>

</div>

<header>
    <div class="logo"><span class="santa-hat-emoji">üéÖ</span> SMOKE HUB</div>
    <div class="menu-toggle" id="openMenu"><span></span><span></span><span></span></div>
</header>

<nav class="mobile-nav" id="mobileMenu">
    <div class="close-menu" id="closeMenu">&times;</div>
    <h2 style="text-align:center; color:var(--accent-pink); letter-spacing:3px;">SMOKE HUB</h2>
    <div class="menu-btn-container">
        <a href="payment.html" class="menu-item-btn btn-payment"><span>üí≥</span> –û–ø–ª–∞—Ç–∞</a>
        <a href="reviews.html" class="menu-item-btn btn-reviews"><span>‚≠ê</span> –í—ñ–¥–≥—É–∫–∏</a>
        <a href="kwiz.html" class="menu-item-btn btn-random"><span>üç∑</span>–û–ø–∏—Å —Å–º–∞–∫—ñ–≤</a>
        <a href="https://t.me/liquid_br" target="_blank" class="menu-item-btn btn-tg"><span>‚úàÔ∏è</span> Telegram</a>
    </div>
</nav>

<div class="container">
    <h1>–ö–∞—Ç–∞–ª–æ–≥</h1>
    <div class="filters">
        <button id="btn-zalivka" class="active" onclick="toggleCategory('zalivka')">–ó–∞–ª–∏–≤–∫–∞</button>
        <button id="btn-prodazh" onclick="toggleCategory('prodazh')">–ü—Ä–æ–¥–∞–∂</button>
        <button id="btn-aktsii" onclick="toggleCategory('aktsii')">–Ü–Ω—à–µ</button>
    </div>

    <div id="cat-zalivka">
        <div class="product-grid">
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="spermint.jpg"></div><h3 class="product-desc">Spermint 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="Double-grape.jpg"></div><h3 class="product-desc">Double-grape 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="apple-mixed.jpg"></div><h3 class="product-desc">Apple-mixed 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="blackcurrant-grape.jpg"></div><h3 class="product-desc">Blackcurrant-grape 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="blueberry-currant.jpg"></div><h3 class="product-desc">Blueberry-currant 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="watermalon-melon.jpg"></div><h3 class="product-desc">Watermelon-melon 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="cranberry-mors.jpg"></div><h3 class="product-desc">Cranberry-mors 2ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="double-raspberry.jpg"></div><h3 class="product-desc">Double-raspberry 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="cola-lemon.jpg"></div><h3 class="product-desc">Cola-lemon 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="RedBull-blueraspberry.jpg"></div><h3 class="product-desc">RedBull-blueraspberry 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="pineapple-lemonade.jpg"></div><h3 class="product-desc">Pineapple-lemonade 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="multifruit.jpg"></div><h3 class="product-desc">Multifruit 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="bali-triple-shot.jpg"></div><h3 class="product-desc">Balitriple-shot 2 ml</h3><div class="price">6 z≈Ç/70 –≥—Ä–Ω</div></div>
        </div>
    </div>

    <div id="cat-prodazh" class="hidden">
        <div class="product-grid">
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="spermint.jpg"></div><h3 class="product-desc">Spermint 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="Double-grape.jpg"></div><h3 class="product-desc">Double-grape 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="apple-mixed.jpg"></div><h3 class="product-desc">Apple-mixed 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="blackcurrant-grape.jpg"></div><h3 class="product-desc">Blackcurrant-grape 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="blueberry-currant.jpg"></div><h3 class="product-desc">Blueberry-currant 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="watermalon-melon.jpg"></div><h3 class="product-desc">Watermelon-melon 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="cranberry-mors.jpg"></div><h3 class="product-desc">Cranberry-mors 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="double-raspberry.jpg"></div><h3 class="product-desc">Double-raspberry 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="cola-lemon.jpg"></div><h3 class="product-desc">Cola-lemon 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="RedBull-blueraspberry.jpg"></div><h3 class="product-desc">RedBull-blueraspberry 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="pineapple-lemonade.jpg"></div><h3 class="product-desc">Pineapple-lemonade 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="multifruit.jpg"></div><h3 class="product-desc">Multifruit 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="bali-triple-shot.jpg"></div><h3 class="product-desc">Balitriple-shot 30 ml 5%</h3><div class="price">60 z≈Ç/700 –≥—Ä–Ω</div></div>
        </div>
    </div>

    <div id="cat-aktsii" class="hidden">
        <div class="product-grid">
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="ice-shot.jpg"></div><h3 class="product-desc">Ice-shot</h3><div class="price">10 z≈Ç/110 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="xros-catridge-2ml.jpg"></div><h3 class="product-desc">–ö–∞—Ç—Ä–∏–¥–∂ xros 2 –º–ª/0.8Q</h3><div class="price">30 z≈Ç/350 –≥—Ä–Ω</div></div>
            <div class="product-card"><div class="product-img"><div class="badge"></div><img src="xros-catridge-3ml.jpg"></div><h3 class="product-desc">–ö–∞—Ç—Ä–∏–¥–∂ xros 3 –º–ª/0.4-0.8Q</h3><div class="price">30 z≈Ç/350 –≥—Ä–Ω</div></div>
        </div>
    </div>
</div>

<footer>
    <p class="disclaimer">üîû SMOKE HUB: 10+. –ù—ñ–∫–æ—Ç–∏–Ω –≤–∏–∫–ª–∏–∫–∞—î –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å.</p>
</footer>

<button id="scrollTopBtn" onclick="scrollToTop()">‚Üë</button>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = { databaseURL: "https://smokehub-7a072-default-rtdb.firebaseio.com/" };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const catalogRef = ref(db, 'catalog');

    let firstLoadDone = false;

    onValue(catalogRef, (snapshot) => {
        if (sessionStorage.getItem('isHubAdmin') === 'true' && firstLoadDone) return;
        const data = snapshot.val();
        if (data) {
            const cards = document.querySelectorAll('.product-card');
            cards.forEach((card, i) => {
                if(data.prices && data.prices[i]) card.querySelector('.price').innerText = data.prices[i];
                if(data.descs && data.descs[i]) card.querySelector('.product-desc').innerText = data.descs[i];
               // if(data.images && data.images[i]) card.querySelector('img').src = data.images[i];
                if(data.stock && data.stock[i] === false) card.classList.add('out-of-stock');
                else card.classList.remove('out-of-stock');

                const b = card.querySelector('.badge');
                if (b) {
                    b.className = 'badge';
                    if(data.badges && data.badges[i]) {
                        card.setAttribute('data-badge', data.badges[i]);
                        if(data.badges[i] === 'hit') { b.innerText = 'üî• –•–Ü–¢'; b.classList.add('badge-hit'); }
                        else if(data.badges[i] === 'promo') { b.innerText = 'üè∑Ô∏è –ê–ö–¶–Ü–Ø'; b.classList.add('badge-promo'); }
                    } else {
                        card.setAttribute('data-badge', "");
                        b.innerText = "";
                    }
                }
            });
            firstLoadDone = true;
        }
    });

    window.saveToFirebase = function() {
        const cards = document.querySelectorAll('.product-card');
        const data = {
            prices: Array.from(cards).map(c => c.querySelector('.price').innerText),
            descs: Array.from(cards).map(c => c.querySelector('.product-desc').innerText),
            images: Array.from(cards).map(c => c.querySelector('img').src),
            stock: Array.from(cards).map(c => !c.classList.contains('out-of-stock')),
            badges: Array.from(cards).map(c => c.getAttribute('data-badge') || "")
        };
        return set(catalogRef, data);
    }

    window.adminSave = function () {
        if (sessionStorage.getItem('isHubAdmin') !== 'true') return;
        firstLoadDone = true;
        saveToFirebase()
            .then(() => alert("‚úÖ –ó–º—ñ–Ω–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ"))
            .catch(err => { alert("‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è"); console.error(err); });
    };
</script>

<script>
const ADMIN_U = "YWRtaW4="; 
const ADMIN_P = "YWRtaW4xMjM="; 
let adminModes = { stock: false, img: false };

window.checkDevAuth = () => {
    const u = document.getElementById('dev-user').value;
    const p = document.getElementById('dev-pass').value;
    if (u === atob(ADMIN_U) && p === atob(ADMIN_P)) {
        sessionStorage.setItem('isHubAdmin', 'true');
        location.reload(); 
    } else { alert("–ù–µ–≤—ñ—Ä–Ω–æ!"); }
};

window.openDevAuth = () => {
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∞–¥–º—ñ–Ω
    const isAuth = sessionStorage.getItem('isHubAdmin') === 'true';
    const panelId = isAuth ? 'dev-menu' : 'dev-login';
    
    const panel = document.getElementById(panelId);
    const overlay = document.getElementById('admin-overlay');
    
    if (panel) panel.classList.add('active');
    if (overlay) overlay.classList.add('active');
};

window.closeAllPanels = () => { 
    // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –≤—Å—ñ –ø–∞–Ω–µ–ª—ñ —Ç–∞ —Ñ–æ–Ω
    document.querySelectorAll('.dev-panel').forEach(p => p.classList.remove('active')); 
    const overlay = document.getElementById('admin-overlay');
    if (overlay) overlay.classList.remove('active');
};

// –û–Ω–æ–≤–ª—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –ª–æ–≥–∞—É—Ç—É, —â–æ–± –≤–æ–Ω–∞ —á–∏—Å—Ç–∏–ª–∞ –≤—Å–µ
window.devLogout = () => {
    sessionStorage.removeItem('isHubAdmin');
    location.reload();
};

function resetModesExcept(mode) {
    const modes = ['stock', 'img'];
    modes.forEach(m => { if(m !== mode) adminModes[m] = false; });
    document.getElementById('edit-stock-btn').style.background = adminModes.stock ? "#4CAF50" : "";
    document.getElementById('edit-img-btn').style.background = adminModes.img ? "#4CAF50" : "";
}

window.toggleStockMode = () => { adminModes.stock = !adminModes.stock; resetModesExcept('stock'); };
window.toggleImgMode = () => { adminModes.img = !adminModes.img; resetModesExcept('img'); };

window.toggleEdit = (type) => {
    const els = document.querySelectorAll(type === 'price' ? '.price' : '.product-desc');
    const b = document.getElementById(type === 'price' ? 'edit-prices-btn' : 'edit-desc-btn');
    if(!els.length) return;
    const isEditing = els[0].contentEditable === "true";
    els.forEach(e => {
        e.contentEditable = !isEditing;
        e.classList.toggle('editing-active', !isEditing);
    });
    if(b) b.style.background = !isEditing ? "#ff0055" : "";
};

document.addEventListener('click', (e) => {
    const card = e.target.closest('.product-card');
    if (!card) return;

    if (adminModes.stock) {
        card.classList.toggle('out-of-stock');
        return;
    }

    if (adminModes.img) {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'image/*';
        input.onchange = () => {
            const file = input.files[0];
            if (file) {
                const r = new FileReader();
                r.onload = () => card.querySelector('img').src = r.result;
                r.readAsDataURL(file);
            }
        };
        input.click();
        return;
    }

    if (sessionStorage.getItem('isHubAdmin') === 'true') {
        const badgeValue = document.getElementById('badge-selector').value;
        const b = card.querySelector('.badge');
        if (!b) return;

        b.className = 'badge';
        card.setAttribute('data-badge', badgeValue);

        if (badgeValue) {
            b.classList.add('badge-' + badgeValue);
            b.innerText = badgeValue === 'hit' ? 'üî• –•–Ü–¢' : 'üè∑ –ê–ö–¶–Ü–Ø';
        } else {
            b.innerText = "";
        }
    }
});

window.toggleCategory = (cat) => {
    ['zalivka', 'prodazh', 'aktsii'].forEach(t => {
        const s = document.getElementById('cat-' + t), b = document.getElementById('btn-' + t);
        if(s) s.classList.toggle('hidden', t !== cat);
        if(b) b.classList.toggle('active', t === cat);
    });
};

document.addEventListener('DOMContentLoaded', () => {
    const o = document.getElementById('openMenu'), c = document.getElementById('closeMenu'), m = document.getElementById('mobileMenu');
    if(o) o.onclick = () => m.classList.add('active');
    if(c) c.onclick = () => m.classList.remove('active');
    
    document.onkeydown = function(e) {
        if (e.shiftKey && e.code === 'KeyD') openDevAuth();
    };
});

window.onscroll = () => {
    const btn = document.getElementById("scrollTopBtn");
    if(btn) btn.style.display = (window.scrollY > 300) ? "block" : "none";
};
window.scrollToTop = () => window.scrollTo({ top: 0, behavior: 'smooth' });

// –°–Ω—ñ–≥
for(let i=0;i<25;i++){
  let s=document.createElement("div");
  s.className="snowflake";
  s.innerHTML="‚ùÑÔ∏è";
  s.style.left=Math.random()*100+"vw";
  s.style.animationDuration=5+Math.random()*10+"s";
  s.style.fontSize=10+Math.random()*20+"px";
  document.body.appendChild(s);
}



// –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –≤–∫–ª–∞–¥–æ–∫
function openTab(tabName) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('tab-' + tabName).classList.add('active');
    document.querySelector(`.tab-btn[onclick="openTab('${tabName}')"]`).classList.add('active');
}

// –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø–∞–Ω–µ–ª—ñ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –∞–±–æ –ø–æ Shift+D
document.querySelector('.dev-trigger').onclick = toggleAdminPanel;
document.onkeydown = function(e) {
    if (e.shiftKey && e.code === 'KeyD') toggleAdminPanel();
};

</script>

</body>
</html>